# music-crawler
Music Crawler 音樂爬蟲

## 1. 項目概述
### 1.1 項目目標
開發一個通過關鍵字搜索音樂的網站，音樂資源來自互聯網，通過搜索引擎或爬蟲技術獲取。網站支持多種音樂格式（如MP3、FLAC等），並提供音樂播放鏈接、下載鏈接和跳轉到原文網址的功能。

### 1.2 項目範圍
- 音樂搜索功能
- 音樂播放和下載功能
- 多語言支持（初期支持中文和英文）
- 离線模式支持
- 單頁應用（SPA）設計

## 2.2 音樂播放和下載
- **播放功能**：
  - 提供內嵌播放器，支持多種音樂格式（MP3、FLAC等）。
  - 支持播放、暫停、音量控制、進度條拖動等功能。
- **下載功能**：
  - 提供跳轉到原文網址的下載鏈接，用戶可以在原始網站上下載。

## 2.3 多語言支持
- **功能描述**：支持多語言界面，初期支持中文和英文，保留其他語言的擴展能力。
- **實現方案**：使用`vue-i18n`。

## 2.4 离線模式
- **功能描述**：支持離線模式，用戶可以在沒有網絡連接的情況下訪問之前搜索過的音樂資源。
- **實現方案**：
  - 使用Service Worker技術實現離線緩存。
  - 使用SQLite作為本地數據庫存儲搜索結果和音樂資源信息。

## 3. 技術實現方案
### 3.1 音樂資源獲取
- **目標網站**：主要來自 Google、Bing、專注於音樂的搜索引擎，以及一些小型的音樂發佈網站。
- **爬蟲架構**：
  - 模塊化設計：每個目標網站對應一個獨立的解析模塊。
  - 任務調度：根據用戶搜索的關鍵字，動態分配爬蟲任務到不同的目標網站。
  - 反爬蟲策略：
    - 請求頻率控制：設置合理的請求間隔。
    - User-Agent輪換：模擬不同瀏覽器和設備的請求頭。
- **資源解析**：
  - HTML結構分析：針對每個目標網站，分析其HTML結構，提取所需信息。
  - 正則表達式與XPath：使用正則表達式或XPath來定位和提取所需數據。
  - 動態頁面處理：使用無頭瀏覽器（如Puppeteer）來模擬用戶行為。
- **數據存儲**：將解析後的音樂資源存儲到SQLite數據庫中。

### 3.2 單頁應用（SPA）設計
- **前端框架**：使用Vue.js構建SPA。
- **狀態管理**：使用Vue的Vuex來管理全局狀態。
- **路由管理**：使用Vue Router實現前端路由。
- **播放器集成**：使用HTML5音頻播放器，或集成第三方播放器庫（如Howler.js）。

### 3.3 离線模式實現
- **本地數據存儲**：使用SQLite作為本地數據庫。
- **前端離線支持**：使用Service Worker技術實現離線緩存。
- **離線模式交互**：實時檢測網絡連接狀態，並在界面中提示用戶當前是否處於離線模式。

### 3.4 打包和分發
- **打包工具**：使用Node.js作為打包工具，選擇`pkg`作為打包工具。
- **分發方式**：提供Windows（.exe）、macOS（.app）和Linux（.bin）的可執行文件下載鏈接。

## 4. 測試計劃
### 4.1 功能測試
- 搜索功能：測試用戶輸入關鍵字後，是否能正確啟動爬蟲程序並返回搜索結果。
- 播放功能：測試播放鏈接是否能正常加載並播放音樂。
- 下載功能：測試下載鏈接是否能正確跳轉到原文網址。
- 离線模式：測試在沒有網絡連接的情況下，是否能正常訪問本地數據庫中的音樂資源。

### 4.2 兼容性測試
- 操作系統：測試應用在Windows、macOS和Linux上的運行情況。
- 瀏覽器：測試前端應用在不同瀏覽器（如Chrome、Firefox、Safari）中的兼容性。

### 4.3 性能測試
- 爬蟲性能：測試爬蟲程序在多個目標網站上的抓取效率和穩定性。
- 前端性能：測試前端應用在加載大量搜索結果時的性能表現。

## 5. 部署方案
### 5.1 本地運行
- 環境要求：用戶需要安裝Node.js環境來運行爬蟲程序和前端服務。
- 啟動流程：用戶下載項目代碼並安裝依賴，通過命令行啟動爬蟲程序和前端服務。

### 5.2 打包與分發
- 打包工具：使用`pkg`將Node.js項目打包成可執行文件。
- 分發方式：提供安裝包下載鏈接，用戶下載後直接安裝即可使用。

## 6. 風險管理
- **技術風險**：爬蟲技術的穩定性和數據解析的準確性。
- **時間風險**：技術實現過程中的不可預見問題。
- **用戶體驗風險**：用戶界面和交互設計的合理性。

## 7. 依賴管理
### 7.1 重新安裝依賴
如果需要重新安裝所有依賴，可以按照以下步驟進行操作：
1. 刪除 `node_modules` 目錄：
   ```bash
   rm -rf node_modules
   ```
2. 刪除 `package-lock.json` 文件：
   ```bash
   rm package-lock.json
   ```
3. 重新安裝依賴：
   ```bash
   npm install
   ```